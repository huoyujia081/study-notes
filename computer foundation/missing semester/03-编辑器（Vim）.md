# 1. 该学哪个编辑器

# 2. Vim的哲学

# 3. 编辑模式

- 正常模式：在文件中四处移动光标进行修改。
- 插入模式：插入文本。
- 替换模式：替换文本。
- 可视化模式（一般，行，块）：选中文本块。
- 命令模式：用于执行命令。

可以按下`ESC`从任何模式回到正常模式。在正常模式下，键入`i`进入插入模式，`R`进入替换模式，`v`进入可视（一般）模式，`V`进入可视（行）模式，`CTRL+v`进入可视（块）模式，`:`进入命令模式。

# 4. 基本操作

## 4.1 插入文本

## 4.2 缓存，标签页，窗口

Vim维护的一系列打开的文件称为*缓存*。一个Vim会话包含一系列标签页，每个标签页包含一系列窗口（分隔面板）。每个窗口显示一个缓存。

> [!Note]
>
> 缓存和窗口不是一一对应的关系，一个缓存可以在多个窗口中打开，甚至在同一个标签页的多个窗口打开。
>
> 因此，可以使用不同的窗口查看同一个文件的不同部分。

`:tabnew`可以新建一个标签页。键入`gt`用于移动光标到下一个标签页，键入`gT`用于移动光标到上一个标签页。

## 4.3 命令行

- `:q` 退出（关闭窗口）
- `:w` 保存（写）
- `:wq` 保存然后退出
- `:e {文件名}` 打开要编辑的文件
- `:ls` 显示打开的缓存
- `:help{标题}` 打开帮助文档
  - `:help :w` 打开 `:w` 命令的帮助文档
  - `:help w` 打开 `w` 移动的帮助文档

# 5. Vim的接口其实是一种编程语言

## 5.1 移动

- 基本移动:`hjkl`（左，下，上，右）
- 词：`w`（word），`b`（beginning），`e`（end）
- 行：`0`（行初），`^`（第一个非空格字符），`$`（行尾）
- 屏幕：`H`（屏幕首行），`M`（屏幕中间），`L`（屏幕底部）
- 翻页：`Ctrl-u`（上翻），`Ctrl-d`（下翻）
- 文件：`gg`（文件头），`G`（文件尾）
- 行数：`:{行数}<ENTER>`或者`{行数}G`({行数}为行数)
- 杂项：`%`（找到配对，比如括号或者/**/之类的注释对）
- 查找：`f{字符}`（find），`t{字符}`（to），`F{字符}`，`T{字符}`
  - 查找向前/向后在本行的{字符}
  - `,`/`;`用于导航匹配
- 搜索:`/{正则表达式}`,`n`/`N`用于导航匹配

## 5.2 选择

进入可视化模式：

- 可视化：`v`
- 可视化行： `V`
- 可视化块：`Ctrl+v`

可以移动命令来选中，然后按下`y`进行复制。

## 5.3 编辑

- `i`进入插入模式，`O`/`o`在之上/之下插入行

- `d{移动命令}`删除{移动命令}。

  例如，`dw`删除词，`d$`删除到行尾，`d^`删除到行头。

  如果输入`dd`，会删除整行。

- `c{移动命令}`改变{移动命令}。

  例如，`cw`改变词相当于`d{移动命令}`再`i`。

  如果输入`cc`，删除整行并且进入插入模式。

- `x`删除字符（等同于dl）。

- `s`替换字符（等同于xi）。

- 可视化模式+操作。选中文字，`d`删除或者`c`改变。

- `u`撤销，`CTRL+r`重做。

- `y`复制（其他一些命令比如d也会复制）。

- `p`粘贴。

- 更多值得学习的：比如~改变字符的大小写。

## 5.4 计数

可以用一个计数来结合“名词”和“动词”，这会执行指定操作若干次。

- `3w` 向后移动三个词
- `5j` 向下移动5行
- `7dw` 删除7个词

## 5.5 修饰词

可以用修饰语改变“名词”的意义。修饰语有`i`，表示“内部”或者“在内”，和`a`， 表示“周围”。

- `ci(` 改变当前括号内的内容
- `ci[` 改变当前方括号内的内容
- `da'` 删除一个单引号字符串， 包括周围的单引号

## 5.6 复制行为

在正常模式下，输入`.`可以复制上一个操作。

> [!Note]
>
> 编辑模式下的所有行为算作一个操作。

# 6. 自定义Vim

Vim的配置文件为`~/.vimrc`。

# 7. 扩展Vim

创建一个`~/.vim/pack/vendor/start/`的文件夹，然后把插件放到这里（比如通过`git clone`）。

- [ctrlp.vim](https://github.com/ctrlpvim/ctrlp.vim): 模糊文件查找
- [ack.vim](https://github.com/mileszs/ack.vim): 代码搜索
- [nerdtree](https://github.com/scrooloose/nerdtree): 文件浏览器
- [vim-easymotion](https://github.com/easymotion/vim-easymotion): 魔术操作

浏览 [Vim Awesome](https://vimawesome.com/) 来了解一些很棒的插件。

## 7.1 ctrlp

Vim 的完整路径模糊**文件**、**缓冲区**、**mru**、**标签**、**...**查找器。

- 用纯 Vimscript 编写，适用于 MacVim、gVim 和 Vim 7.0+。
- 完全支持 Vim 的正则表达式作为搜索模式。
- 内置最近使用 (MRU) 文件监控。
- 内置项目的根查找器。
- 一次打开多个文件。
- 创建新文件和目录。
- 可扩展。

### 7.1.1 安装

```bash
mkdir -p ~/.vim/pack/plugins/start
git clone --depth=1 https://github.com/ctrlpvim/ctrlp.vim.git ~/.vim/pack/plugins/start/ctrlp
```

将以下内容加入`~/.vimrc`，以修改在Vim中启动`ctrlp`的快捷键为`CTRL+P`。

```bash
let g:ctrlp_map = '<c-p>'
let g:ctrlp_cmd = 'CtrlP'
```

### 7.1.2 基本用法

##### 打开 CtrlP 后：

- 按下`<F5>`可清除当前目录的缓存以获取新文件、删除已删除的文件并应用新的忽略选项。
- 按`<c-f>`和`<c-b>`在模式之间循环。
- 按此键`<c-d>`切换到仅搜索文件名而不是完整路径。
- 按此键`<c-r>`切换到正则表达式模式。
- ==使用`<c-j>`、`<c-k>`或箭头键导航结果列表。==
- ==通常使用`<c-t>`开启新tab，使用`<c-x>`开启新窗口。==
- ==使用`<c-n>`,`<c-p>`选择提示历史记录中的下一个/上一个字符串。==
- ==用于`<c-y>`创建新文件及其父目录。==
- 用于`<c-z>`标记/取消标记多个文件并`<c-o>`打开它们。

# 8. 其他程序的Vim模式

# 9. Vim进阶

## 9.2 多窗口

使用`:sp`来分割窗口，可以使用`-e 文件名`来打开另外一个文件，使用`CTRL+w+方向键`移动光标到另外一个窗口，使用`:q`关闭光标所在窗口，使用`:qa`关闭所有窗口。

