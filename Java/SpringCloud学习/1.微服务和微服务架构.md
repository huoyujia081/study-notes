# 什么是微服务

​		到目前为止，业界也没有一个关于微服务的具体的统一的定义。

​		但通常而言，微服务架构是一种架构模式，也是一种架构的风格。它将一个单一的应用分成一组服务，每个服务运行在属于自己的进程中，并且服务与服务之间通过轻量级的机制（如http，RPC等）进行通信，相互协调，共同为完成应用程序的功能提供价值。每个服务都能够被独立地部署，另外，应尽量避免统一的，集中式的服务管理机制。这些服务可以根据应用上下文选择合适的开发语言，也可以选择独立的数据库，由一个轻量级的集中式管理来协调这些服务。

​		简单来说，微服务化的核心就是将传统的一站式应用，根据业务拆分成一个一个的服务，彻底地去耦合，每一个微服务提供单个业务功能的服务，一个服务做一件事情，从技术角度看就是一种小而独立的处理过程，类似进程的概念，能够自行单独启动或销毁，拥有自己独立的数据库。

参考资料：[https://www.cnblogs.com/liuning8023/p/4493156.html](https://www.cnblogs.com/liuning8023/p/4493156.html)

# 微服务和微服务架构

## 微服务

​		微服务强调的是服务的大小，关注的是某一个具体的服务能解决某一个具体的业务功能。实际来说，微服务相当于idea项目中的module。强调的是一个个的个体，每个个体完成一个具体的任务或者功能。

## 微服务架构

​		微服务架构更多的是强调整个项目的架构思想，将一个单一的业务拆分成一组相互独立的服务，服务之间通过轻量级的通信机制来进行通信，共同协作完成应用程序的功能。每个服务都运行在独立的进程中，并且能够被独立地部署到生产环境。

# 微服务的优缺点

## 优点

- 单一职责原则；
- 每个服务足够内聚，足够小，代码容易理解，这样能聚焦一个指定的业务功能或业务需求；
- 开发简单，开发效率高，一个服务可能就是专一的只干一件事；
- 微服务能够被小团队单独开发，这个团队只需2-5个开发人员组成；
- 微服务是松耦合的，是有功能意义的服务，无论是在开发阶段或部署阶段都是独立的；
- 微服务能使用不同的语言开发；
- 易于和第三方集成，微服务允许容易且灵活的方式集成自动部署，通过持续集成工具，如jenkins，Hudson，bamboo；
- 微服务易于被一个开发人员理解，修改和维护，这样小团队能够更关注自己的工作成果，无需通过合作才能体现价值；
- 微服务允许利用和融合最新技术；
- **微服务只是业务逻辑的代码，不会和HTML，CSS，或其他的界面混合;**
- **每个微服务都有自己的存储能力，可以有自己的数据库，也可以有统一的数据库**

## 缺点

- 开发人员要处理分布式系统的复杂性；
- 多服务运维难度，随着服务的增加，运维的压力也在增大；
- 系统部署依赖问题；
- 服务间通信成本问题；
- 数据一致性问题；
- 系统集成测试问题；
- 性能和监控问题；

# 微服务的技术栈

| **微服务技术条目**                     | 落地技术                                                     |
| -------------------------------------- | ------------------------------------------------------------ |
| 服务开发                               | SpringBoot、Spring、SpringMVC等                              |
| 服务配置与管理                         | Netfix公司的Archaius、阿里的Diamond等                        |
| 服务注册与发现                         | Eureka、Consul、Zookeeper等                                  |
| 服务调用                               | Rest、PRC、gRPC                                              |
| 服务熔断器                             | Hystrix、Envoy等                                             |
| 负载均衡                               | Ribbon、Nginx等                                              |
| 服务接口调用(客户端调用服务的简化工具) | Fegin等                                                      |
| 消息队列                               | Kafka、RabbitMQ、ActiveMQ等                                  |
| 服务配置中心管理                       | SpringCloudConfig、Chef等                                    |
| 服务路由(API网关)                      | Zuul等                                                       |
| 服务监控                               | Zabbix、Nagios、Metrics、Specatator等                        |
| 全链路追踪                             | Zipkin、Brave、Dapper等                                      |
| 数据流操作开发包                       | SpringCloud Stream(封装与Redis，Rabbit，Kafka等发送接收消息) |
| 时间消息总栈                           | SpringCloud Bus                                              |
| 服务部署                               | Docker、OpenStack、Kubernetes等                              |

# 为什么选择SpringCloud作为微服务架构

## 选型依据

- 整体解决方案和框架成熟度
- 社区热度
- 可维护性
- 学习曲线

## 大公司所使用的微服务架构

- 阿里：dubbo+HFS

- 京东：JFS

- 新浪：Motan

- 当当网：DubboX

  …

# 各微服务框架对比

| 服务框架       | Netflix/SpringCloud                                          | Motan                       | gRPC                      | Thrift   | Dubbo/Dubbox                        |
| -------------- | ------------------------------------------------------------ | --------------------------- | ------------------------- | -------- | ----------------------------------- |
| 功能定位       | 完整的微服务架构                                             | RPC框架，但整合了ZK或Consul | RPC框架                   | RPC框架  | 服务框架                            |
| 支持Rest       | 支持                                                         | No                          | No                        | No       | No                                  |
| 支持RPC        | SpringCloud不支持RPC，但是SpringCloud可以和Dubbo兼容。       | No                          | No                        | No       | No                                  |
| 支持多语言     | 是                                                           | No                          | 是                        | 是       | No                                  |
| 负载均衡       | 是（服务端zuul+客户端Ribbon），zuul-服务，动态路由，云端负载均衡Eureka（针对中间层服务器） | 是（客户端）                | No                        | No       | 是（客户端）                        |
| 配置服务       | Netfix Archaius，Spring Cloud Config Server集中配置          | 是（zookeeper提供）         | No                        | No       | No                                  |
| 服务调用链监控 | 是（zuul），zuul提供边缘服务，API网关                        | No                          | No                        | No       | No                                  |
| 高可用/容错    | 是（服务端Hystrix+客户端Ribbon）                             | 是（客户端）                | No                        | No       | 是（客户端）                        |
| 典型应用案例   | Netflix                                                      | Sina                        | Google                    | Facebook |                                     |
| 社区活跃程度   | 高                                                           | 一般                        | 高                        | 一般     | 2017年后重新开始维护，之前中段了5年 |
| 学习难度       | 中                                                           | 低                          | 高                        | 高       | 低                                  |
| 文档丰富程度   | 高                                                           | 一般                        | 一般                      | 一般     | 高                                  |
| 其他           | Spring Cloud Bus为我们应用程序带来了更多管理端点             | 支持降级                    | Netflix内部在开发集成gRPC | IDL定义  | 实践的公司比较多                    |
